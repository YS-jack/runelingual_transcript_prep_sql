(()=>{"use strict";var e,t,r,n,a,o,i,s,c={1361:()=>{},2994:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{Z:()=>x});var a=r(2535),o=r(9593),i=r(7722),s=r(2602),c=r(8344),l=r(3438),d=r(2434),u=r(584),f=e([c]);function p(e){let t;return{c(){t=(0,a.fLW)("Viewer")},m(e,r){(0,a.$Tr)(e,t,r)},d(e){e&&(0,a.ogt)(t)}}}function h(e){let t;return{c(){t=(0,a.fLW)("Editor")},m(e,r){(0,a.$Tr)(e,t,r)},d(e){e&&(0,a.ogt)(t)}}}function m(e){let t;return{c(){t=(0,a.fLW)("Config")},m(e,r){(0,a.$Tr)(e,t,r)},d(e){e&&(0,a.ogt)(t)}}}function g(e){let t,r,n,o,i,s,c,l=e[0].text+"";return{c(){t=(0,a.bGB)("div"),r=(0,a.bGB)("div"),n=(0,a.fLW)(l),o=(0,a.DhX)(),i=(0,a.bGB)("button"),i.textContent="Ok",(0,a.Ljt)(i,"class","svelte-7qdw3g"),(0,a.Ljt)(r,"class","popup svelte-7qdw3g"),(0,a.Ljt)(t,"class","toplevel popup-container svelte-7qdw3g")},m(l,d){(0,a.$Tr)(l,t,d),(0,a.R3I)(t,r),(0,a.R3I)(r,n),(0,a.R3I)(r,o),(0,a.R3I)(r,i),s||(c=[(0,a.oLt)(i,"click",e[3]),(0,a.oLt)(t,"click",(0,a.AT7)(e[3]))],s=!0)},p(e,t){1&t&&l!==(l=e[0].text+"")&&(0,a.rTO)(n,l)},d(e){e&&(0,a.ogt)(t),s=!1,(0,a.j7q)(c)}}}function y(e){let t,r,n,s,c,f,y,$,k,x,C,L,T,_,j,E,I,S,P,O,q,B,R;function Z(t){e[5](t)}let A={key:"viewer",$$slots:{default:[p]},$$scope:{ctx:e}};function N(t){e[6](t)}void 0!==e[1]&&(A.tab=e[1]),n=new o.Z({props:A}),a.VnY.push((()=>(0,a.akz)(n,"tab",Z)));let U={key:"editor",$$slots:{default:[h]},$$scope:{ctx:e}};function M(t){e[7](t)}void 0!==e[1]&&(U.tab=e[1]),c=new o.Z({props:U}),a.VnY.push((()=>(0,a.akz)(c,"tab",N)));let D={key:"config",$$slots:{default:[m]},$$scope:{ctx:e}};void 0!==e[1]&&(D.tab=e[1]),y=new o.Z({props:D}),a.VnY.push((()=>(0,a.akz)(y,"tab",M))),x=new u.Z({}),_=new d.Z({props:{icon:l.LcO,alt:"Github"}}),E=new i.Z({props:{tab:e[1],key:"viewer",async:w}}),S=new i.Z({props:{tab:e[1],key:"editor",async:v}}),O=new i.Z({props:{tab:e[1],key:"config",async:b}});let G=e[0]&&g(e);return{c(){t=(0,a.bGB)("div"),r=(0,a.bGB)("div"),(0,a.YCL)(n.$$.fragment),(0,a.YCL)(c.$$.fragment),(0,a.YCL)(y.$$.fragment),k=(0,a.DhX)(),(0,a.YCL)(x.$$.fragment),C=(0,a.DhX)(),L=(0,a.bGB)("span"),T=(0,a.bGB)("a"),(0,a.YCL)(_.$$.fragment),j=(0,a.DhX)(),(0,a.YCL)(E.$$.fragment),I=(0,a.DhX)(),(0,a.YCL)(S.$$.fragment),P=(0,a.DhX)(),(0,a.YCL)(O.$$.fragment),q=(0,a.DhX)(),G&&G.c(),B=(0,a.cSb)(),(0,a.Ljt)(T,"href","https://github.com/abextm/cache2/"),(0,a.Ljt)(L,"class","links svelte-7qdw3g"),(0,a.Ljt)(r,"class","tabbar svelte-7qdw3g"),(0,a.Ljt)(t,"class","main toplevel svelte-7qdw3g")},m(e,o){(0,a.$Tr)(e,t,o),(0,a.R3I)(t,r),(0,a.yef)(n,r,null),(0,a.yef)(c,r,null),(0,a.yef)(y,r,null),(0,a.R3I)(r,k),(0,a.yef)(x,r,null),(0,a.R3I)(r,C),(0,a.R3I)(r,L),(0,a.R3I)(L,T),(0,a.yef)(_,T,null),(0,a.R3I)(t,j),(0,a.yef)(E,t,null),(0,a.R3I)(t,I),(0,a.yef)(S,t,null),(0,a.R3I)(t,P),(0,a.yef)(O,t,null),(0,a.$Tr)(e,q,o),G&&G.m(e,o),(0,a.$Tr)(e,B,o),R=!0},p(e,[t]){const r={};512&t&&(r.$$scope={dirty:t,ctx:e}),!s&&2&t&&(s=!0,r.tab=e[1],(0,a.hjT)((()=>s=!1))),n.$set(r);const o={};512&t&&(o.$$scope={dirty:t,ctx:e}),!f&&2&t&&(f=!0,o.tab=e[1],(0,a.hjT)((()=>f=!1))),c.$set(o);const i={};512&t&&(i.$$scope={dirty:t,ctx:e}),!$&&2&t&&($=!0,i.tab=e[1],(0,a.hjT)((()=>$=!1))),y.$set(i);const l={};2&t&&(l.tab=e[1]),E.$set(l);const d={};2&t&&(d.tab=e[1]),S.$set(d);const u={};2&t&&(u.tab=e[1]),O.$set(u),e[0]?G?G.p(e,t):(G=g(e),G.c(),G.m(B.parentNode,B)):G&&(G.d(1),G=null)},i(e){R||((0,a.Ui)(n.$$.fragment,e),(0,a.Ui)(c.$$.fragment,e),(0,a.Ui)(y.$$.fragment,e),(0,a.Ui)(x.$$.fragment,e),(0,a.Ui)(_.$$.fragment,e),(0,a.Ui)(E.$$.fragment,e),(0,a.Ui)(S.$$.fragment,e),(0,a.Ui)(O.$$.fragment,e),R=!0)},o(e){(0,a.etI)(n.$$.fragment,e),(0,a.etI)(c.$$.fragment,e),(0,a.etI)(y.$$.fragment,e),(0,a.etI)(x.$$.fragment,e),(0,a.etI)(_.$$.fragment,e),(0,a.etI)(E.$$.fragment,e),(0,a.etI)(S.$$.fragment,e),(0,a.etI)(O.$$.fragment,e),R=!1},d(e){e&&(0,a.ogt)(t),(0,a.vpE)(n),(0,a.vpE)(c),(0,a.vpE)(y),(0,a.vpE)(x),(0,a.vpE)(_),(0,a.vpE)(E),(0,a.vpE)(S),(0,a.vpE)(O),e&&(0,a.ogt)(q),G&&G.d(e),e&&(0,a.ogt)(B)}}}c=(f.then?(await f)():f)[0];const w=()=>Promise.all([r.e(782),r.e(370),r.e(562),r.e(910)]).then(r.bind(r,2724)),v=()=>Promise.all([r.e(782),r.e(370),r.e(562),r.e(631)]).then(r.bind(r,1285)),b=()=>Promise.all([r.e(782),r.e(370),r.e(893)]).then(r.bind(r,1893));function $(e,t,r){let n,o,i,l=(0,s.a)("tab","config");return(0,a.FIv)(e,l,(e=>r(1,n=e))),c.dT.subscribe((e=>{document.body.classList.remove(e?"light":"dark"),document.body.classList.add(e?"dark":"light")})),[o,n,l,function(){let e=o;r(0,o=void 0),e?.resolve()},async function(e){try{await i}catch(e){}return i=new Promise(((t,n)=>r(0,o={text:e,resolve:t,reject:n})))},function(e){n=e,l.set(n)},function(e){n=e,l.set(n)},function(e){n=e,l.set(n)}]}class k extends a.f_C{constructor(e){super(),(0,a.S1n)(this,e,$,y,a.N8,{forceInteraction:4})}get forceInteraction(){return this.$$.ctx[4]}}const x=k;n()}catch(C){n(C)}}))},9593:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(2535);function a(e){let t,r,a,o;const i=e[3].default,s=(0,n.nuO)(i,e,e[2],null);return{c(){t=(0,n.bGB)("span"),s&&s.c(),(0,n.Ljt)(t,"class","svelte-16m26uq"),(0,n.VHj)(t,"selected",e[1]&&e[0]===e[1])},m(i,c){(0,n.$Tr)(i,t,c),s&&s.m(t,null),r=!0,a||(o=(0,n.oLt)(t,"click",(0,n.AT7)(e[4])),a=!0)},p(e,[a]){s&&s.p&&(!r||4&a)&&(0,n.kmG)(s,i,e,e[2],r?(0,n.u2N)(i,e[2],a,null):(0,n.VOJ)(e[2]),null),3&a&&(0,n.VHj)(t,"selected",e[1]&&e[0]===e[1])},i(e){r||((0,n.Ui)(s,e),r=!0)},o(e){(0,n.etI)(s,e),r=!1},d(e){e&&(0,n.ogt)(t),s&&s.d(e),a=!1,o()}}}function o(e,t,r){let{$$slots:n={},$$scope:a}=t,{tab:o}=t,{key:i}=t;return e.$$set=e=>{"tab"in e&&r(0,o=e.tab),"key"in e&&r(1,i=e.key),"$$scope"in e&&r(2,a=e.$$scope)},[o,i,a,n,()=>r(0,o=i)]}class i extends n.f_C{constructor(e){super(),(0,n.S1n)(this,e,o,a,n.N8,{tab:0,key:1})}}const s=i},7722:(e,t,r)=>{r.d(t,{Z:()=>p});var n=r(2535);function a(e){let t,r,a,s;const c=[i,o],l=[];function d(e,t){return e[2]?0:1}return r=d(e),a=l[r]=c[r](e),{c(){t=(0,n.bGB)("div"),a.c(),(0,n.Ljt)(t,"class","tab-contents svelte-b1vm1c"),(0,n.czc)(t,"display",e[0]===e[1]?"block":"none",!1)},m(e,a){(0,n.$Tr)(e,t,a),l[r].m(t,null),s=!0},p(e,o){let i=r;r=d(e),r===i?l[r].p(e,o):((0,n.dvw)(),(0,n.etI)(l[i],1,1,(()=>{l[i]=null})),(0,n.gbL)(),a=l[r],a?a.p(e,o):(a=l[r]=c[r](e),a.c()),(0,n.Ui)(a,1),a.m(t,null)),3&o&&(0,n.czc)(t,"display",e[0]===e[1]?"block":"none",!1)},i(e){s||((0,n.Ui)(a),s=!0)},o(e){(0,n.etI)(a),s=!1},d(e){e&&(0,n.ogt)(t),l[r].d()}}}function o(e){let t;const r=e[5].default,a=(0,n.nuO)(r,e,e[4],null);return{c(){a&&a.c()},m(e,r){a&&a.m(e,r),t=!0},p(e,o){a&&a.p&&(!t||16&o)&&(0,n.kmG)(a,r,e,e[4],t?(0,n.u2N)(r,e[4],o,null):(0,n.VOJ)(e[4]),null)},i(e){t||((0,n.Ui)(a,e),t=!0)},o(e){(0,n.etI)(a,e),t=!1},d(e){a&&a.d(e)}}}function i(e){let t,r,a,o={ctx:e,current:null,token:null,hasCatch:!1,pending:l,then:c,catch:s,value:6,blocks:[,,,]};return(0,n.CR_)(r=e[2](),o),{c(){t=(0,n.cSb)(),o.block.c()},m(e,r){(0,n.$Tr)(e,t,r),o.block.m(e,o.anchor=r),o.mount=()=>t.parentNode,o.anchor=t,a=!0},p(t,a){e=t,o.ctx=e,4&a&&r!==(r=e[2]())&&(0,n.CR_)(r,o)||(0,n.xfz)(o,e,a)},i(e){a||((0,n.Ui)(o.block),a=!0)},o(e){for(let e=0;e<3;e+=1){const t=o.blocks[e];(0,n.etI)(t)}a=!1},d(e){e&&(0,n.ogt)(t),o.block.d(e),o.token=null,o=null}}}function s(e){return{c:n.ZTd,m:n.ZTd,p:n.ZTd,i:n.ZTd,o:n.ZTd,d:n.ZTd}}function c(e){let t,r,a;var o=e[6].default;return o&&(t=new o({})),{c(){t&&(0,n.YCL)(t.$$.fragment),r=(0,n.cSb)()},m(e,o){t&&(0,n.yef)(t,e,o),(0,n.$Tr)(e,r,o),a=!0},p(e,a){if(o!==(o=e[6].default)){if(t){(0,n.dvw)();const e=t;(0,n.etI)(e.$$.fragment,1,0,(()=>{(0,n.vpE)(e,1)})),(0,n.gbL)()}o?(t=new o({}),(0,n.YCL)(t.$$.fragment),(0,n.Ui)(t.$$.fragment,1),(0,n.yef)(t,r.parentNode,r)):t=null}},i(e){a||(t&&(0,n.Ui)(t.$$.fragment,e),a=!0)},o(e){t&&(0,n.etI)(t.$$.fragment,e),a=!1},d(e){e&&(0,n.ogt)(r),t&&(0,n.vpE)(t,e)}}}function l(e){let t;return{c(){t=(0,n.fLW)("Loading...")},m(e,r){(0,n.$Tr)(e,t,r)},p:n.ZTd,i:n.ZTd,o:n.ZTd,d(e){e&&(0,n.ogt)(t)}}}function d(e){let t,r,o=e[3]&&a(e);return{c(){o&&o.c(),t=(0,n.cSb)()},m(e,a){o&&o.m(e,a),(0,n.$Tr)(e,t,a),r=!0},p(e,[r]){e[3]?o?(o.p(e,r),8&r&&(0,n.Ui)(o,1)):(o=a(e),o.c(),(0,n.Ui)(o,1),o.m(t.parentNode,t)):o&&((0,n.dvw)(),(0,n.etI)(o,1,1,(()=>{o=null})),(0,n.gbL)())},i(e){r||((0,n.Ui)(o),r=!0)},o(e){(0,n.etI)(o),r=!1},d(e){o&&o.d(e),e&&(0,n.ogt)(t)}}}function u(e,t,r){let{$$slots:n={},$$scope:a}=t,{key:o}=t,{tab:i}=t,{async:s}=t,c=!1;return e.$$set=e=>{"key"in e&&r(0,o=e.key),"tab"in e&&r(1,i=e.tab),"async"in e&&r(2,s=e.async),"$$scope"in e&&r(4,a=e.$$scope)},e.$$.update=()=>{11&e.$$.dirty&&r(3,c=c||o===i)},[o,i,s,c,a,n]}class f extends n.f_C{constructor(e){super(),(0,n.S1n)(this,e,u,d,n.N8,{key:0,tab:1,async:2})}}const p=f},2434:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(2535);function a(e){let t,r,a,o;return{c(){t=(0,n.bi5)("svg"),r=(0,n.bi5)("title"),a=(0,n.fLW)(e[1]),o=(0,n.bi5)("path"),(0,n.Ljt)(o,"d",e[0]),(0,n.Ljt)(t,"xmlns","http://www.w3.org/2000/svg"),(0,n.Ljt)(t,"viewBox","0 0 24 24"),(0,n.Ljt)(t,"class","mdi"),(0,n.Ljt)(t,"style",e[2])},m(e,i){(0,n.$Tr)(e,t,i),(0,n.R3I)(t,r),(0,n.R3I)(r,a),(0,n.R3I)(t,o)},p(e,[r]){2&r&&(0,n.rTO)(a,e[1]),1&r&&(0,n.Ljt)(o,"d",e[0]),4&r&&(0,n.Ljt)(t,"style",e[2])},i:n.ZTd,o:n.ZTd,d(e){e&&(0,n.ogt)(t)}}}function o(e,t,r){let{icon:n}=t,{alt:a}=t,{style:o}=t;return e.$$set=e=>{"icon"in e&&r(0,n=e.icon),"alt"in e&&r(1,a=e.alt),"style"in e&&r(2,o=e.style)},[n,a,o]}class i extends n.f_C{constructor(e){super(),(0,n.S1n)(this,e,o,a,n.N8,{icon:0,alt:1,style:2})}}const s=i},584:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(2535),a=r(7491);function o(e){let t,r,a;return{c(){t=(0,n.bGB)("div"),r=(0,n.DhX)(),a=(0,n.fLW)(e[0]),(0,n.Ljt)(t,"class","spinner svelte-za3e83")},m(e,o){(0,n.$Tr)(e,t,o),(0,n.$Tr)(e,r,o),(0,n.$Tr)(e,a,o)},p(e,t){1&t&&(0,n.rTO)(a,e[0])},d(e){e&&(0,n.ogt)(t),e&&(0,n.ogt)(r),e&&(0,n.ogt)(a)}}}function i(e){let t,r=e[0]&&o(e);return{c(){t=(0,n.bGB)("span"),r&&r.c(),(0,n.Ljt)(t,"class","status svelte-za3e83")},m(e,a){(0,n.$Tr)(e,t,a),r&&r.m(t,null)},p(e,[n]){e[0]?r?r.p(e,n):(r=o(e),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},i:n.ZTd,o:n.ZTd,d(e){e&&(0,n.ogt)(t),r&&r.d()}}}function s(e,t,r){let n;{let o=[],i=new Map;function s(e){o.filter((t=>t.owner!==e)),r(0,n=o.at(-1)?.text)}new BroadcastChannel(`status-${a.hP}`).addEventListener("message",(e=>{if("add"===e.data.type)o.push(e.data),e.data.isWorkerReadyChange&&i.set(e.data.owner,setTimeout((()=>s(e.data.owner)),1e4));else if("remove"===e.data.type){let t=o.findIndex((t=>t.owner===e.data.owner&&t.text===e.data.text));if(-1===t)return void console.warn("unknown status remove",e);o.splice(t,1),e.data.isWorkerReadyChange&&(clearTimeout(i.get(e.data.owner)),i.delete(e.data.owner),navigator.locks.request(`worker-running-${e.data.owner}`,(()=>{})).then((()=>s(e.data.owner))))}r(0,n=o.at(-1)?.text)}))}return[n]}class c extends n.f_C{constructor(e){super(),(0,n.S1n)(this,e,s,i,n.N8,{})}}const l=c},6875:(e,t,r)=>{r.d(t,{AS:()=>o,YG:()=>i,dt:()=>s});var n=r(326),a=r(6777);let o;function i(e){o=e}function s(){if(o instanceof n.S)return o.newPort();{if(!o)throw new Error("must setCacheShare");let e=new MessageChannel;return new a.m(e.port1,o),e.port2}}},326:(e,t,r)=>{r.d(t,{S:()=>o});var n=r(456);const a=-1!==navigator.userAgent.indexOf("Gecko")?class extends Object{message="Ignore this unhandled rejection - Service client closed"}:class extends Error{constructor(){super("Service client closed")}};self.addEventListener("unhandledrejection",(e=>{e.reason instanceof a&&e.preventDefault()}));class o{_port;_nextID=1;_requests=new Map;constructor(e,t){this._port=e,e.onmessage=e=>t(e)||this._handle(e),e instanceof n.mo&&e.exited.then((e=>this.rejectAll()))}static create(e,t=(()=>!1)){let r=new o(e,t),n=()=>{throw new Error};return new Proxy(r,{defineProperty:n,deleteProperty:n,get:(e,t)=>t in e?e[t]:"string"==typeof t?(...e)=>r._request(t,e):void 0,isExtensible:e=>!1,set:n})}close(){"terminate"in this._port?this._port.terminate():"close"in this._port&&this._port.close(),this.rejectAll()}rejectAll(){for(let{reject:e}of this._requests.values())e(new a)}then=void 0;newPort(){let e=new MessageChannel;return this._post({type:"newPort",id:-1,args:[e.port1]},[e.port1]),e.port2}_request(e,t){const r=this._nextID++,n=new Promise(((e,t)=>this._requests.set(r,{resolve:e,reject:t})));return this._post({id:r,type:e,args:t},t.filter((e=>e instanceof MessagePort))),n}async _handle(e){if(!("id"in e.data))return void console.log("bad message",e);let t=e.data,r=this._requests.get(t.id);r?(this._requests.delete(t.id),"error"in t?r.reject(t.error):r.resolve(t.value)):console.log("duplicate response",t)}_post(e,t){this._port instanceof n.mo&&!this._port.isRunning?this._port.ready.then((r=>this._port.postMessage(e,t))):this._port.postMessage(e,t)}}},6777:(e,t,r)=>{r.d(t,{m:()=>a});class n{v;transfer;constructor(e,t){this.v=e,this.transfer=t}}class a{port;handler;constructor(e,t){this.port=e,this.handler=t,e.onmessage=e=>this.handle(e)}static return(e,t){throw new n(e,t)}async handle(e){if(!("id"in e.data))return void console.log("bad message",e);let t=e.data;if("newPort"!=t.type)try{if(t.type in this.handler){let e=await this.handler[t.type](...t.args);this.post({id:t.id,value:e})}}catch(e){if(e instanceof n)return void this.post({id:t.id,value:e.v},e.transfer);console.debug(e);let r={name:e?.name||Object.getPrototypeOf(e)?.constructor?.name||typeof e,message:e.message||JSON.stringify(e),stack:e.stack||""};this.post({id:t.id,error:r})}else{let e=t.args[0];new a(e,this.handler)}}post(e,t=[]){this.port.postMessage(e,t)}}},8344:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{I5:()=>y,Xc:()=>u,dT:()=>h,db:()=>l,ok:()=>m,pc:()=>w,pd:()=>g,rc:()=>d});var a=r(8023),o=r(3330);const i=new BroadcastChannel("tableChanged"),s=new BroadcastChannel("tableChanged");let c=await(0,a.X3)("cache2-viewer",1,{upgrade(e,t){t<1&&(e.createObjectStore("files",{autoIncrement:!0}),e.createObjectStore("config"),e.createObjectStore("fileCache"))}});const l=new Proxy(c,{get(e,t,r){let n=Reflect.get(e,t,r);return"transaction"===t?function(...e){let t=n.apply(c,e);return"readonly"!==t.mode&&t.addEventListener("complete",(e=>{i.postMessage(Array.from(t.objectStoreNames))})),t}:n}});async function d(e){let t=[],r=l.transaction(e,"readonly");for await(let n of r.objectStore(e).iterate())t.push([n.primaryKey,n.value]);return t}function u(e,t,r){Array.isArray(e)||(e=[e]);let n=(0,o.fZ)(r,(r=>{function n(n){n.data.some((t=>-1!==e.indexOf(t)))&&t().then(r)}return s.addEventListener("message",n),()=>{s.removeEventListener("message",n)}})),a={subscribe:n.subscribe,get:t,ready:void 0};return a.ready=(async()=>{try{n.set(await t())}catch(e){console.error(e)}return a})(),a}function f(e,t,r,n){let a=u(e,t,n);return a.set=r,a.update=e=>{t().then(e).then(r)},a}function p(e,t){return f(["config"],(async()=>{let r=await l.get("config",e);return r||t}),(t=>{l.put("config",t,e)}),t)}const h=await p("darkMode","matchMedia"in self&&self.matchMedia("(prefers-color-scheme: dark)").matches).ready,m={type:"github",username:"abextm",repo:"osrs-cache",commitish:"master"},g={...m,commitish:"master^"},y=p("defaultCache",m),w=p("altCache",g);n()}catch(v){n(v)}}),1)},2602:(e,t,r)=>{r.d(t,{a:()=>s});var n=r(8784),a=r(3330);let o={...history.state,...c(window.location.hash)},i=[];function s(e,t,r="push"){let s=(0,a.fZ)(o&&e in o?o[e]:t);return s.subscribe((t=>{if(o[e]=t,history.state&&(0,n.isEqual)(o[e],history.state[e]))return;let a=function(e){if(!e.tab)return;let t=[e.tab];"viewer"===e.tab&&e.viewerKey&&(t.push(e.viewerKey),e.viewerFilter&&t.push(e.viewerFilter));return"#/"+t.map(encodeURIComponent).join("/")}(o);"push"===r&&a!==window.location.hash?history.pushState(o,"",a):history.replaceState(o,"",a)})),i.push([s,e]),s}function c(e){let t=(e=e.replace(/^[^#]*#?\/?/,"")).split("/").map(decodeURIComponent),r={};if(r.tab=t[0],"viewer"===r.tab)r.viewerKey=t[1],r.viewerFilter=t[2];else if("editor"!==r.tab&&"config"!==r.tab)return{};return r}window.addEventListener("popstate",(e=>{o={...o,...history.state,...c(window.location.hash)};for(let[e,t]of i)e.set(o[t])}))},5103:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{$E:()=>u,IE:()=>d,W1:()=>i,d0:()=>c,yB:()=>f});var a=r(8344),o=e([a]);a=(o.then?(await o)():o)[0];const i="getAsFileSystemHandle"in DataTransferItem.prototype,s=new Map;async function c(){let e=[],t=a.db.transaction("files","readonly");for await(let r of t.objectStore("files").iterate())e.push([r.key,r.value]),s.set(r.key,r.value);let r=e.map((async([e,t])=>{let r=await t.queryPermission({mode:"read"});if("granted"===r)return await d(e);if("denied"===r)return console.log(`removing entry ${t.name} because permission was denied`),void u(e);let n=await a.db.get("fileCache",e);if(!n)try{return await d(e)}catch(t){return{key:e,type:"idbnoperms"}}return n}));return(await Promise.all(r)).filter((e=>e)).map((e=>e))}async function l(e,t,r){if("file"===e.kind)return e.name.endsWith(".json")&&/xtea/i.test(e.name)?{type:"idbxtea",key:t,name:e.name,path:r}:void 0;let n,a,o=e,i=new Map,s=[];for await(let[e,t]of o)"file"===t.kind&&i.set(e,t),s.push(t);i.has("main_file_cache.dat2")?n="disk":i.has("0.flatcache")&&(n="flat"),n&&(a={type:"idb",key:t,name:e.name,style:n,path:r});let c=(await Promise.all(s.map((e=>l(e,t,[...r,e.name]))))).filter((e=>e)).map((e=>e));if(c.length<=0)return a;let d=new Intl.Collator(void 0,{numeric:!0,ignorePunctuation:!0,sensitivity:"variant"}).compare;return c.sort(((e,t)=>d(e.name,t.name))),a&&c.unshift(a),{type:"idbdir",name:e.name,key:t,entries:c}}async function d(e,t){if(t||(t=await f(e)),!t)throw new Error("bad key");let r=await t.queryPermission({mode:"read"});"granted"!==r&&(r=await t.requestPermission({mode:"read"}),"granted"!==r&&(console.log(`removing entry ${t.name} because permission was denied`),u(e)));let n=await l(t,e,[]);return n?a.db.put("fileCache",n,e):(console.log(`removing entry ${t.name} because it has no cache`),u(e)),n}function u(e){a.db.delete("files",e),a.db.delete("fileCache",e)}async function f(e){let t=await a.db.get("files",e);return s.set(e,t),t}n()}catch(p){n(p)}}))},5962:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var n=r(6875),a=r(456),o=r(5103),i=r(2994),s=e([o,i]);async function c(e,t){let r=await(0,o.yB)(e.key);if("granted"!==await r.queryPermission({mode:"read"}))try{let t=await r.requestPermission({mode:"read"});if("granted"!==t)throw new Error(`${e.name}: read permission denied (${t})`)}catch(t){if("SecurityError"===t.name){await l.forceInteraction("We require permissions again...");let t=await r.requestPermission({mode:"read"});if("granted"!==t)throw new Error(`${e.name}: read permission denied (${t})`)}}for(let n=0;n<e.path.length;n++){let a=r;r=n===e.path.length-1&&"file"===t?await a.getFileHandle(e.path[n]):await a.getDirectoryHandle(e.path[n])}return r}[o,i]=s.then?(await s)():s,(0,a.Iw)(),(0,n.YG)({async loadCacheDirectory(e){let t={entries:{},key:e};if("idb"!==e.type)throw new Error(`unknown type "${e.type}"`);{let r=await c(e,"dir");for await(let e of r.values())"file"===e.kind&&(t.entries[e.name]=await e.getFile())}return t},async loadXTEA(e){if("idbxtea"===e.type){let t=await c(e,"file");return await t.getFile()}throw new Error(`unknown type "${e.type}"`)}});const l=new i.Z({target:document.body});t()}catch(d){t(d)}}))},456:(e,t,r)=>{r.d(t,{mo:()=>o,Iw:()=>a.Iw,Aq:()=>a.Aq});var n=r(7491),a=r(1393);class o extends Worker{workerIdentifier;ready;exited;isRunning=!1;constructor(e){const t=(0,n.D9)();let r=new Promise(((e,r)=>{let a=setTimeout((()=>{r(new Error("Worker failed to start"))}),2e4),o=r=>{r.data.owner==t&&r.data.isWorkerReadyChange&&"remove"==r.data.type&&(n.wB.removeEventListener("message",o),clearTimeout(a),this.isRunning=!0,e(this))};n.wB.addEventListener("message",o)}));n.wB.postMessage({owner:t,text:(0,n.Ad)(e),type:"add",isWorkerReadyChange:!0}),super(`worker.js#${n.hP}-${t}`,{name:e}),this.workerIdentifier=t,this.ready=r,this.exited=(async()=>{try{await r}catch(e){return}await navigator.locks.request((0,n.qm)(e,t),(()=>{}))})()}}},7491:(e,t,r)=>{function n(){let e=new Uint8Array(12);return self.crypto.getRandomValues(e),[...e].map((e=>e.toString(16))).join("")}r.d(t,{Ad:()=>s,D9:()=>n,E6:()=>i,hP:()=>o,qm:()=>c,wB:()=>l});const a=!("window"in self),[o,i]=(()=>{if(a){let e=/^#?([a-f0-9]+)-([a-f0-9]+)$/i.exec(self.location.hash);if(!e)throw new Error("invalid worker url: "+self.location.hash);return[e[1],e[2]]}return[n(),n()]})();function s(e){return`Starting ${{mw_ts:"Typescript worker",mw_json:"JSON worker",mw_editor:"Editor",runner:"Runner"}[e]}`}function c(e,t){return`worker-running-${e}-${t}`}const l=new BroadcastChannel(`status-${o}`)},1393:(e,t,r)=>{r.d(t,{Aq:()=>o,Iw:()=>i});var n=r(7491);function a(e){let t;return setTimeout((()=>{void 0===t&&(!function(e){n.wB.postMessage({owner:n.E6,text:e,type:"add"})}(e),t="added")}),10),()=>{"added"===t&&function(e){n.wB.postMessage({owner:n.E6,text:e,type:"remove"})}(e),t="done"}}function o(e,t){return t.finally(a(e)),t}function i(){let e=r.status,t=()=>{},n=e.onChange=(e,r)=>{1!=e||r?0==e&&r&&t():t=a("Loading code")};e.loading&&n(e.loading,!1)}}},l={};function d(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={id:e,loaded:!1,exports:{}};return c[e].call(r.exports,r,r.exports,d),r.loaded=!0,r.exports}d.m=c,d.x=()=>{d.O(void 0,[709],(()=>d(5962)));var e=d.O(void 0,[709],(()=>d(1361)));return e=d.O(e)},d.amdO={},e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},d.a=(a,o,i)=>{var s;i&&((s=[]).d=-1);var c,l,d,u=new Set,f=a.exports,p=new Promise(((e,t)=>{d=t,l=e}));p[t]=f,p[e]=e=>(s&&e(s),u.forEach(e),p.catch((e=>{}))),a.exports=p,o((a=>{var o;c=(a=>a.map((a=>{if(null!==a&&"object"==typeof a){if(a[e])return a;if(a.then){var o=[];o.d=0,a.then((e=>{i[t]=e,n(o)}),(e=>{i[r]=e,n(o)}));var i={};return i[e]=e=>e(o),i}}var s={};return s[e]=e=>{},s[t]=a,s})))(a);var i=()=>c.map((e=>{if(e[r])throw e[r];return e[t]})),l=new Promise((t=>{(o=()=>t(i)).r=0;var r=e=>e!==s&&!u.has(e)&&(u.add(e),e&&!e.d&&(o.r++,e.push(o)));c.map((t=>t[e](r)))}));return o.r?l:i()}),(e=>(e?d(p[r]=e):l(f),n(s)))),s&&s.d<0&&(s.d=0)},a=[],d.O=(e,t,r,n)=>{if(!t){var o=1/0;for(l=0;l<a.length;l++){for(var[t,r,n]=a[l],i=!0,s=0;s<t.length;s++)(!1&n||o>=n)&&Object.keys(d.O).every((e=>d.O[e](t[s])))?t.splice(s--,1):(i=!1,n<o&&(o=n));if(i){a.splice(l--,1);var c=r();void 0!==c&&(e=c)}}return e}n=n||0;for(var l=a.length;l>0&&a[l-1][2]>n;l--)a[l]=a[l-1];a[l]=[t,r,n]},d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},d.d=(e,t)=>{for(var r in t)d.o(t,r)&&!d.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},d.f={},d.e=e=>Promise.all(Object.keys(d.f).reduce(((t,r)=>(d.f[r](e,t),t)),[])),d.e=(e=>{let t=d.status={loading:0,onChange:()=>{}};return(...r)=>(t.onChange(++t.loading,!1),e(...r).finally((()=>t.onChange(--t.loading,!0))))})(d.e),d.u=e=>e+".js",d.miniCssF=e=>e+".css",d.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},i="viewer:",d.l=(e,t,r,n)=>{if(o[e])o[e].push(t);else{var a,s;if(void 0!==r)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var u=c[l];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==i+r){a=u;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,d.nc&&a.setAttribute("nonce",d.nc),a.setAttribute("data-webpack",i+r),a.src=e),o[e]=[t];var f=(t,r)=>{a.onerror=a.onload=null,clearTimeout(p);var n=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((e=>e(r))),t)return t(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),s&&document.head.appendChild(a)}},d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;d.g.importScripts&&(e=d.g.location+"");var t=d.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&!e;)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),d.p=e})(),(()=>{if("undefined"!=typeof document){var e=e=>new Promise(((t,r)=>{var n=d.miniCssF(e),a=d.p+n;if(((e,t)=>{for(var r=document.getElementsByTagName("link"),n=0;n<r.length;n++){var a=(i=r[n]).getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(a===e||a===t))return i}var o=document.getElementsByTagName("style");for(n=0;n<o.length;n++){var i;if((a=(i=o[n]).getAttribute("data-href"))===e||a===t)return i}})(n,a))return t();((e,t,r,n,a)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onerror=o.onload=r=>{if(o.onerror=o.onload=null,"load"===r.type)n();else{var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=i,c.request=s,o.parentNode&&o.parentNode.removeChild(o),a(c)}},o.href=t,r?r.parentNode.insertBefore(o,r.nextSibling):document.head.appendChild(o)})(e,a,null,t,r)})),t={179:0};d.f.miniCss=(r,n)=>{t[r]?n.push(t[r]):0!==t[r]&&{497:1,631:1,893:1,910:1}[r]&&n.push(t[r]=e(r).then((()=>{t[r]=0}),(e=>{throw delete t[r],e})))}}})(),(()=>{var e={179:0};d.f.j=(t,r)=>{var n=d.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise(((r,a)=>n=e[t]=[r,a]));r.push(n[2]=a);var o=d.p+d.u(t),i=new Error;d.l(o,(r=>{if(d.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",i.name="ChunkLoadError",i.type=a,i.request=o,n[1](i)}}),"chunk-"+t,t)}},d.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[o,i,s]=r,c=0;if(o.some((t=>0!==e[t]))){for(n in i)d.o(i,n)&&(d.m[n]=i[n]);if(s)var l=s(d)}for(t&&t(r);c<o.length;c++)a=o[c],d.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return d.O(l)},r=self.webpackChunkviewer=self.webpackChunkviewer||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),s=d.x,d.x=()=>d.e(709).then(s);d.x()})();
//# sourceMappingURL=main.js.map